package dao;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.util.Date;

import conexaoBD.Conexao;
import vo.Cronograma;
public class CronogramaDAO {
	
	public boolean criarCronograma(Cronograma c) {
		Connection conn =  null;
		PreparedStatement ps = null;
		conn = new Conexao().getConnection();
		
		String sql= "INSERT INTO CronogramaOlimpiada(nomeOlimpiada, comecoInscricoes, fimInscricoes, comecoFase1"+
		", fimFase1, comecoFase2, fimFase2, comecoFase3, fimFase3, comecoFase4, fimFase4, comecoPremiacoes"+
		", fimPremiacoes)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?)";
		
		try {

			ps = conn.prepareStatement(sql);
			ps.setString(1, c.getNomeOlimpiada());
			ps.setDate(2, (java.sql.Date) c.getComecoInscricoes());
			ps.setDate(3, (java.sql.Date) c.getFimInscricoes());
			ps.setDate(4, (java.sql.Date) c.getComecoFase1());
			ps.setDate(5, (java.sql.Date) c.getFimFase1());
			ps.setDate(6, (java.sql.Date) c.getComecoFase2());
			ps.setDate(7, (java.sql.Date) c.getFimFase2());
			ps.setDate(8, (java.sql.Date) c.getComecoFase3());
			ps.setDate(9, (java.sql.Date) c.getFimFase3());
			ps.setDate(10, (java.sql.Date) c.getComecoFase4());
			ps.setDate(11, (java.sql.Date) c.getFimFase4());
			ps.setDate(12, (java.sql.Date) c.getComecoPremiacoes());
			ps.setDate(13, (java.sql.Date) c.getFimPremiacoes());

						
			int linhasAfetadas = ps.executeUpdate();
			
			ps.close();
			conn.close();
			
            if(linhasAfetadas>0) {
            	return true;
            }else {
            	return false;
            }
            
		}catch (SQLException e) {
			e.printStackTrace();
			return false;
		}
	}
	
	public boolean atualizarCronograma(Cronograma c) {
		Connection conn =  null;
		PreparedStatement ps = null;
		conn = new Conexao().getConnection();
		
		String sql= "UPDATE CronogramaOlimpiada SET comecoInscricoes = ?, fimInscricoes = ?, comecoFase1 = ?"+
		", fimFase1 = ?, comecoFase2 = ?, fimFase2 = ?, comecoFase3 = ?, fimFase3 = ?, comecoFase4 = ?, fimFase4 = ?,"
		+ " comecoPremiacoes = ?"+
		", fimPremiacoes = ? WHERE nomeOlimpiada = ?";
		
		try {
			ps = conn.prepareStatement(sql);
			ps.setString(1, c.getNomeOlimpiada());
			ps.setDate(2, (java.sql.Date) c.getComecoInscricoes());
			ps.setDate(3, (java.sql.Date) c.getFimInscricoes());
			ps.setDate(4, (java.sql.Date) c.getComecoFase1());
			ps.setDate(5, (java.sql.Date) c.getFimFase1());
			ps.setDate(6, (java.sql.Date) c.getComecoFase2());
			ps.setDate(7, (java.sql.Date) c.getFimFase2());
			ps.setDate(8, (java.sql.Date) c.getComecoFase3());
			ps.setDate(9, (java.sql.Date) c.getFimFase3());
			ps.setDate(10, (java.sql.Date) c.getComecoFase4());
			ps.setDate(11, (java.sql.Date) c.getFimFase4());
			ps.setDate(12, (java.sql.Date) c.getComecoPremiacoes());
			ps.setDate(13, (java.sql.Date) c.getFimPremiacoes());
						
			int linhasAfetadas = ps.executeUpdate();
			
			ps.close();
			conn.close();
			
            if(linhasAfetadas>0) {
            	return true;
            }else {
            	return false;
            }
            
		}catch (SQLException e) {
			e.printStackTrace();
			return false;
		}
	}
}
